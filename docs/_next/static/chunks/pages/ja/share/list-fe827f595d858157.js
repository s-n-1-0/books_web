(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[748],{5877:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ja/share/list",function(){return n(3404)}])},3404:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return P}});var r=n(1799);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a=n(5893),i=n(7138),o=n(6774),c=n(5717),u=n(3108),d=n(6),x=n(8953),m=n(1443),h=n(7294),f=(0,h.createContext)({selectedStore:"amazon",setSelectedStore:function(e){}}),b=function(e){var t=e.children,n=(0,h.useContext)(f),r=(0,h.useState)(n.selectedStore),s=r[0],l=r[1];return(0,a.jsx)(f.Provider,{value:{selectedStore:s,setSelectedStore:l},children:t})},j=n(7094),p=n(1055),y=n(909),g=n(7313),N=n(7259),v=n(4549),w=n(2336),k=n(9881),S=n(9417),C=n(7814),U=n(4184),R=n.n(U),L=n(1163);function _(e){var t=e.bookData,n=e.children,r=(0,h.useContext)(f),s=r.selectedStore,l=r.setSelectedStore,i=(0,h.useState)(!1),o=i[0],c=i[1];return(0,a.jsxs)("div",{className:"flex h-full items-center",children:[(0,a.jsxs)("div",{className:"flex justify-center flex-col",children:[(0,a.jsx)("span",{className:"text-center text-slate-500",children:"購入先"}),function(){switch(s){case"amazon":return(0,a.jsx)(j.Z,{isbn:t.isbn});case"honto":return(0,a.jsx)(p.Z,{isbn:t.isbn});case"kinokuniya":return(0,a.jsx)(y.Z,{isbn:t.isbn})}}(),(0,a.jsx)("button",{className:"text-blue-500 mt-1 underline cursor-pointer",onClick:function(){c(!0)},children:"他のストア..."}),function(){if(o)return(0,a.jsxs)("ul",{className:"w-full cursor-pointer text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg",children:[(0,a.jsx)("li",{className:"w-full px-4 py-2 border-b border-gray-200 rounded-t-lg",onClick:function(){l("amazon"),c(!1)},children:"Amazon"}),(0,a.jsx)("li",{className:"w-full px-4 py-2 border-b border-gray-200",onClick:function(){l("kinokuniya"),c(!1)},children:"紀ノ國屋"}),(0,a.jsx)("li",{className:"w-full px-4 py-2 rounded-b-lg",onClick:function(){l("honto"),c(!1)},children:"Honto"})]})}()]}),n]})}function A(){var e=(0,L.useRouter)(),t=e.query,n=t.store,s=t.books,c=t.title,u=(0,h.useContext)(x.U),d=(0,h.useContext)(m.F),b=(0,h.useContext)(f),j=b.selectedStore,p=b.setSelectedStore,y=(0,h.useState)([]),U=y[0],A=y[1],P=(0,h.useState)(""),T=P[0],Z=P[1],E=T.split("\n").map(function(e,t){return(0,a.jsxs)("span",{children:[e,(0,a.jsx)("br",{})]},t)}),z=(0,h.useState)("無名のリスト"),D=z[0],I=z[1],O=(0,h.useState)(!1),F=O[0],B=O[1],G={hidden:!F},X=(0,h.useState)(""),$=X[0],q=X[1],H=(0,h.useState)(!1),M=H[0],Q=H[1];(0,h.useEffect)(function(){p(function(){var e="string"==typeof n?n:"";switch(e){case"amazon":case"honto":case"kinokuniya":return e;default:return"amazon"}}()),"string"==typeof c&&""!=c&&I(c)},[n,p,c]),(0,h.useEffect)(function(){if(e.isReady)try{var t=[];if(Array.isArray(s))t=Array.from(new Set(s)).map(function(e){return new URL(d.makeUrlFromSearchParams("/ja/share",new URLSearchParams(e)))});else if("string"==typeof s){var n,r=new URL(d.makeUrlFromSearchParams("/ja/share",new URLSearchParams(s)));if((null===(n=r.pathname.split("/"))||void 0===n?void 0:n[2])!=="share"||null==r.searchParams.get("isbn"))return;t=[r]}t.length>0&&A(t),B(0==t.length)}catch(l){}},[s,e.isReady]);var W="コピーしているURLが有効ではありません。\n追加する書籍の情報画面にある「この本を共有する」を押して書籍URLをコピーした状態で押してください。",J=function(e){try{if(!(0,w.xr)(e)){Z(W);return}var t=Array.from(new Set(l(U.map(function(e){return e.href})).concat([e.href]))).map(function(e){return new URL(e)});A(t),Z("")}catch(n){Z(W)}};return(0,a.jsxs)("div",{className:" mx-auto mt-1 ",style:{maxWidth:"1200px"},children:[function(){if(!(U.length>0))return(0,a.jsx)("h3",{className:"pt-5 text-xl text-center pb-2 text-slate-700",children:(0,a.jsx)("span",{className:"ml-1",children:"複数の書籍をまとめて共有することができます。"})})}(),(0,a.jsxs)("div",{role:"alert",className:"my-2 "+R()(G),children:[(0,a.jsx)("div",{className:"bg-yellow-500 text-white font-bold rounded-t px-4 py-2 mt-1",children:"注意"}),(0,a.jsx)("div",{className:"border border-t-0 border-yellow-400 rounded-b bg-yellow-100 px-4 py-3 text-yellow-700",children:(0,a.jsxs)("ul",{className:"list-disc px-4",children:[(0,a.jsx)("li",{children:"リストの内容を変更すると共有URLも更新されます!"}),(0,a.jsxs)("li",{children:[(0,a.jsx)("b",{children:"このページは再読み込みすると元に戻ります。"}),(0,a.jsx)("br",{}),"リストの編集完了後、「共有URLを生成」を押してリストURLをコピーし、メモ帳やNotionなどで保管してください。"]})]})})]}),M?(0,a.jsx)("input",{type:"text",value:D,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 ",onChange:function(e){I(e.target.value)}}):(0,a.jsxs)("h2",{className:R()({"text-2xl":!0,underline:F}),onClick:function(){F&&Q(!0)},children:[D,(0,a.jsx)("span",{className:R()((0,r.Z)({"text-sm":!0},G)),children:"(編集)"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-end",children:F?(0,a.jsxs)("span",{children:[(0,a.jsxs)("span",{className:R()({hidden:(0,N.T)()}),children:[(0,a.jsx)("button",{className:"mr-1 text-blue-500 underline mb-1",onClick:function(){window.location.href=(0,w.k5)(U,j,D)},children:"一時保存(リロード)"}),"/"]}),(0,a.jsx)("button",{className:"mx-1 text-blue-500 underline mb-1",onClick:function(){window.open("./list")},children:"新規リスト(別タブ)"})]}):(0,a.jsx)("button",{className:"mr-1 text-sm text-blue-500 underline mb-1",onClick:function(){B(!0)},children:"リストの追加・編集する"})}),(0,a.jsxs)("ul",{className:"w-full text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg",children:[U.map(function(e,t){return(0,a.jsx)(i.Q,{url:e,position:0==t?"top":"center",headText:String(t+1),makeRightElement:function(e){return(0,a.jsx)(_,{bookData:e,children:(0,a.jsx)("div",{className:R()(G),children:(0,a.jsx)("button",{className:"text-xl ml-5 text-yellow-600",onClick:function(){var e=l(U);e.splice(t,1),A(e)},children:(0,a.jsx)(C.G,{icon:S.g82})})})})},onClickTitle:(0,N.T)()?void 0:function(t){var n,r=null!==(n=e.searchParams.get("comment"))&&void 0!==n?n:"";window.open(d.makeSharePageUrl(t.isbn,t.from,r))}},e.href)}),(0,a.jsx)("li",{className:"w-full px-4 py-2 rounded-b-lg text-center my-2 cursor-pointer "+R()(G),children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-secondary",children:"リストに追加する書籍を検索 (書籍共有URLも入力できます)"}),(0,a.jsx)(o.Z,{errorText:"",getBookData:function(e){J(new URL(d.makeSharePageUrl(e.isbn,e.from,"")))}})]})})]})]}),(0,a.jsx)("div",{className:"text-center m-3",children:(0,a.jsxs)("div",{className:"w-full mt-1",children:[(0,a.jsx)("p",{className:R()({"text-end":!0,hidden:F}),children:(0,a.jsx)("button",{className:"mr-1 text-sm text-blue-500 underline mb-1",onClick:function(){B(!0)},children:"リストの追加・編集する"})}),(0,a.jsx)("small",{className:"text-red-500",children:E})]})}),(0,a.jsx)("hr",{className:"my-3"})," ",function(){if(0!=U.length)return(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("button",{className:"bg-blue-500 hover:bg-blue-400 text-white font-bold py-2 px-4 m-1 border-b-4 border-blue-700 hover:border-blue-500 rounded",onClick:function(){B(!1),Q(!1),Z(""),q("共有URLをコピーしました。"),v.Z.writeText((0,w.k5)(U,j,D))},children:"共有URLを生成"})," ",(0,a.jsx)("p",{className:"text-secondary",children:(0,a.jsx)("small",{children:$})}),(0,a.jsxs)("div",{className:"flex flex-wrap justify-center items-center",children:[(0,a.jsx)("div",{className:"m-1",children:(0,a.jsx)(g.Z,{text:"「".concat(D,"」の共有"),url:(0,w.k5)(U,j,D)})}),(0,a.jsxs)("button",{onClick:function(){Z(""),B(!1),q("マークダウン形式でコピーしました。"),v.Z.writeText((0,k.cI)(U.map(function(e){var t,n=null!==(t=e.searchParams.get("isbn"))&&void 0!==t?t:"";return{url:e,bookData:u.bookDataCaches[n]}}),j,D,d))},className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-full inline-flex items-center m-1",children:[(0,a.jsx)(C.G,{icon:S.kZ_,className:"mr-1"}),(0,a.jsx)("span",{children:"マークダウン形式で共有"})]})]}),(0,a.jsxs)("small",{className:"text-secondary",children:[(0,a.jsx)("b",{children:"note"}),"や",(0,a.jsx)("b",{children:"Notion"}),"などのサイトには「マークダウン形式で共有」がおすすめです!"]})]})}()]})}var P=function(){return(0,a.jsx)(b,{children:(0,a.jsx)(x.f,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)(u.Z,{title:"本を知り合いに「まとめて」紹介する - 読書日より/Share Books",description:"登録不要で簡単に書籍を共有・紹介できるサイトです。共有先が利用する書店に合わせて複数の書籍を共有することができます!",pageUrl:"https://books.sn-10.net/ja/share/list",ogType:"product"}),(0,a.jsx)(d.Z,{}),(0,a.jsx)("main",{children:(0,a.jsx)("div",{className:"w-full px-2 ",children:(0,a.jsx)(A,{})})}),(0,a.jsx)(c.$,{})]})})})}}},function(e){e.O(0,[948,996,235,57,774,888,179],function(){return e(e.s=5877)}),_N_E=e.O()}]);